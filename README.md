# MNIST Digit Classifier (PyTorch)

An end-to-end handwritten digit recognition project built with PyTorch.

## Highlights

- Fully connected neural network for MNIST (`0-9` classification)
- Training + evaluation pipeline
- Saved model checkpoint for reuse
- Live drawing canvas prediction with OpenCV
- GPU/CPU auto device selection

## Tech Stack

- Python
- PyTorch + Torchvision
- NumPy
- OpenCV
- Matplotlib

## Project Structure

```text
MNIST/
  src/
    config.py          # Hyperparameters and device config
    data_loader.py     # MNIST download + dataloaders
    model.py           # CNN architecture
    train.py           # Training + evaluation + metrics + graphs
  data/                # Downloaded MNIST dataset
  models/
    mnist_cnn.pth      # Trained model weights
  results/
    loss_graph.png         # Training vs validation loss graph
    training_metrics.json  # Training history and accuracy
    sec_prediction.png     # Sample prediction visualization
  predict_draw.py      # Live draw-and-predict app
  README.md
```

## Model Architecture

`CNN` from `src/model.py`:

- Input: `28x28` grayscale image
- Convolutional layers with pooling
- Output: `10` class logits

## Training Output

After running `python -m src.train`, you'll get:

- **loss_graph.png**: Shows training vs validation loss across epochs
- **training_metrics.json**: Contains final accuracy, loss history, hyperparameters
- **sec_prediction.png**: Visualization of first test sample prediction

## Setup

1. Clone the repository
2. Create and activate a virtual environment
3. Install dependencies

```bash
pip install -r requirements.txt
```

## Training

Run from project root:

```bash
python -m src.train
```

This will:

- Download MNIST (if not already present) into `data/`
- Train for configured epochs with loss tracking
- Track both training and validation loss each epoch
- Evaluate on test set and report accuracy
- Save model to `models/mnist_cnn.pth`
- Generate **loss_graph.png** showing training progress
- Export **training_metrics.json** with full training history
- Save sample prediction image to `results/sec_prediction.png`

## Live Prediction (Draw Your Own Digit)

After training:

```bash
python predict_draw.py
```

Controls:

- Hold left mouse button to draw
- `c` to clear
- `q` to quit

## Configuration

You can tune settings in `src/config.py`:

- Data: batch size, shuffle, workers
- Training: learning rate, epochs, weight decay
- Model: hidden sizes, dropout rate

Current defaults:

- Epochs: `40`
- Batch size: `64`
- Learning rate: `0.005`

## Results

Training prints final test accuracy in terminal.  
Example output image generated by training:

![First prediction](results/sec_prediction.png)

Loss graph plot

![LOSS GRAPH](results/loss_graph.png)

## Future Improvements
- Add data augmentation for better generalization
- Add confusion matrix and per-class metrics
- Export model to ONNX/TorchScript
- Build REST API (FastAPI) and web UI deployment
- Add Docker + CI workflow for reproducible training
